# Bunjang Parser Bot

Telegram бот для парсинга товаров с сайта globalbunjang.com и автоматической отправки в Telegram.

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Создайте файл `.env` в корне проекта:
```
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
```

**Примечание:** `TELEGRAM_CHAT_ID` больше не требуется! Бот автоматически отправляет товары всем пользователям, которые подписались через команду `/start`.

## Получение токена Telegram бота

1. Найдите [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Скопируйте полученный токен в `.env` файл

## Запуск

### Тестирование парсера

Сначала можно протестировать парсер отдельно:

```bash
python test_parser.py
```

Это проверит, работает ли парсинг товаров с сайта.

### Запуск бота

```bash
python main.py
```

Бот будет автоматически парсить товары с сайта globalbunjang.com и отправлять новые товары всем пользователям, которые подписались через команду `/start`.

## Команды бота

- `/start` - подписаться на рассылку новых товаров
- `/stop` - отписаться от рассылки
- `/status` - проверить статус подписки

## Настройка

В файле `config.py` можно изменить:
- `PARSING_INTERVAL` - интервал парсинга в секундах (по умолчанию 3600 = 1 час)
- `MAX_PRODUCTS_PER_MESSAGE` - максимальное количество товаров за один запуск

## Структура проекта

- `main.py` - главный файл для запуска бота
- `parser.py` - парсер для сайта globalbunjang.com
- `bot.py` - класс для работы с Telegram API
- `database.py` - работа с базой данных для хранения отправленных товаров
- `config.py` - конфигурация бота
- `requirements.txt` - зависимости проекта

## Примечания

- Бот сохраняет отправленные товары в локальную базу данных SQLite (`products.db`)
- Бот сохраняет информацию о пользователях в той же базе данных
- Новые товары определяются по уникальной ссылке
- При первом запуске бот отправит все найденные товары всем подписанным пользователям
- Пользователи могут подписаться/отписаться в любое время через команды бота
- Если сайт использует JavaScript для загрузки контента, парсер автоматически попробует использовать Selenium
- Для работы с Selenium необходимо установить ChromeDriver (см. https://chromedriver.chromium.org/)

## Использование Selenium

Если обычный парсинг не работает (сайт загружает контент через JavaScript), парсер автоматически попробует использовать Selenium. Для принудительного использования Selenium:

1. Установите ChromeDriver: https://chromedriver.chromium.org/
2. Добавьте в `.env` файл:
   ```
   USE_SELENIUM=true
   ```

Парсер автоматически переключится на Selenium, если найдет мало товаров при обычном парсинге.

